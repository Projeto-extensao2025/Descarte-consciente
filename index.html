<!DOCTYPE html>
<html>
  <head>
    <title>Localizador de Filiais</title>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA60hBk_LFnjdEClfi02jfI1KlaHPiDPc4&libraries=geometry"></script>
    <style>
      #map {
        height: 100%;
      }
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
  </head>
  <body>
    <div id="map"></div>
    <script>
      let map;
      let filiais = [
        { nome: "Filial 1", lat: -23.12345, lng: -45.12345 },
        { nome: "Filial 2", lat: -23.54321, lng: -45.54321 },
        { nome: "Filial 3", lat: -23.67890, lng: -45.67890 },
      ];

      function initMap() {
        // Inicializa o mapa com uma posi√ß√£o padr√£o
        map = new google.maps.Map(document.getElementById("map"), {
          center: { lat: -23.55052, lng: -46.633308 }, // Posi√ß√£o inicial gen√©rica (S√£o Paulo)
          zoom: 12,
        });

        // Marca todas as filiais no mapa
        filiais.forEach((filial) => {
          new google.maps.Marker({
            position: { lat: filial.lat, lng: filial.lng },
            map: map,
            title: filial.nome,
          });
        });

        // Obt√©m a localiza√ß√£o do usu√°rio
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(
            (position) => {
              const userLocation = {
                lat: position.coords.latitude,
                lng: position.coords.longitude,
              };

              // Centraliza o mapa na posi√ß√£o do usu√°rio
              map.setCenter(userLocation);

              // Marca a posi√ß√£o do usu√°rio no mapa
              new google.maps.Marker({
                position: userLocation,
                map: map,
                title: "Voc√™ est√° aqui!",
                icon: { url: "http://maps.google.com/mapfiles/ms/icons/blue-dot.png" }, // √çcone azul para o usu√°rio
              });

              // Calcula a filial mais pr√≥xima
              let filialMaisProxima = filiais.reduce((maisProxima, filial) => {
                const distancia = google.maps.geometry.spherical.computeDistanceBetween(
                  new google.maps.LatLng(userLocation.lat, userLocation.lng),
                  new google.maps.LatLng(filial.lat, filial.lng)
                );
                if (!maisProxima || distancia < maisProxima.distancia) {
                  return { ...filial, distancia };
                }
                return maisProxima;
              }, null);

              // Marca a filial mais pr√≥xima com um marcador especial
              new google.maps.Marker({
                position: { lat: filialMaisProxima.lat, lng: filialMaisProxima.lng },
                map: map,
                title: `Filial mais pr√≥xima: ${filialMaisProxima.nome}`,
                icon: { url: "http://maps.google.com/mapfiles/ms/icons/green-dot.png" }, // √çcone verde para a filial mais pr√≥xima
              });

              alert(`A filial mais pr√≥xima √©: ${filialMaisProxima.nome}`);
            },
            (error) => {
              console.error("Erro ao obter a localiza√ß√£o:", error.message);
              alert("N√£o foi poss√≠vel obter sua localiza√ß√£o.");
            }
          );
        } else {
          alert("Geolocaliza√ß√£o n√£o √© suportada pelo seu navegador.");
        }
      }

      // Inicializa o mapa
      window.onload = initMap;
    </script>
  </body>
</html>
```

---

### Altera√ß√µes feitas:
1. **Exibi√ß√£o de todas as filiais**:
   - Usei `filiais.forEach()` para adicionar um marcador para cada filial no mapa.
   - Cada marcador exibe o nome da filial ao passar o mouse.

2. **Destaque da filial mais pr√≥xima**:
   - Adicionei um marcador especial com √≠cone verde para a filial mais pr√≥xima.

3. **Destaque da posi√ß√£o do usu√°rio**:
   - O marcador do usu√°rio agora usa um √≠cone azul para diferenci√°-lo das filiais.

4. **Estilo aprimorado**:
   - √çcones personalizados ajudam na visualiza√ß√£o (√≠cone azul para o usu√°rio e verde para a filial mais pr√≥xima).

---

### Resultado esperado:
- Quando o mapa for carregado, todas as filiais ser√£o exibidas.
- A posi√ß√£o do usu√°rio ser√° centralizada no mapa com um marcador azul.
- A filial mais pr√≥xima ser√° destacada com um marcador verde e um alerta ser√° exibido com seu nome.

Teste e veja se funciona corretamente! Caso precise ajustar mais alguma coisa, √© s√≥ me dizer. üòä[43dcd9a7-70db-4a1f-b0ae-981daa162054](https://github.com/Advanced-Web-Techniques-project-group/robinsnest/tree/30029abddfbc3a1aff1169c1d4ee92590af08631/Location.php?citationMarker=43dcd9a7-70db-4a1f-b0ae-981daa162054 "1")[43dcd9a7-70db-4a1f-b0ae-981daa162054](https://github.com/JuanDavidCastellomRodriguez/cmd/tree/2da956ff45b70990d4989a5d74939129dcd8dd4b/resources%2Fviews%2Fmapa%2Fmaps.blade.php?citationMarker=43dcd9a7-70db-4a1f-b0ae-981daa162054 "2")
